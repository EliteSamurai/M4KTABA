name: Synthetic Cron

on:
  schedule:
    - cron: '*/5 * * * *'
  workflow_dispatch:

jobs:
  synthetic:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: '20'
      - run: corepack enable
      - run: pnpm install --no-frozen-lockfile
      - run: npx playwright install chromium
      - run: |
          export NEXT_PUBLIC_SYNTH=1
          export SYNTH_BASE_URL=${{ secrets.SYNTH_PROD_BASE_URL }}
          echo "üîç Environment variables:"
          echo "NEXT_PUBLIC_SYNTH=$NEXT_PUBLIC_SYNTH"
          echo "SYNTH_BASE_URL=$SYNTH_BASE_URL"
          node scripts/synth/checkout-smoke.js
